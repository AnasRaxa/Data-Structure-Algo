// same code as book allocation